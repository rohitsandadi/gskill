{
    "patch": "diff --git a/pygments/lexers/configs.py b/pygments/lexers/configs.py\nindex 365a88a1..5e560e6e 100644\n--- a/pygments/lexers/configs.py\n+++ b/pygments/lexers/configs.py\n@@ -1394,15 +1394,30 @@ class SingularityLexer(RegexLexer):\n     }\n \n     def analyse_text(text):\n-        \"\"\"This is a quite simple script file, but there are a few keywords\n-        which seem unique to this language.\"\"\"\n-        result = 0\n-        if re.search(r'\\b(?:osversion|includecmd|mirrorurl)\\b', text, re.IGNORECASE):\n-            result += 0.5\n-\n-        if re.search(SingularityLexer._section[1:], text):\n-            result += 0.49\n+        \"\"\"Heuristics for :func:`pygments.lexers.guess_lexer`.\n+\n+        Singularity definition files typically contain a short header block\n+        (e.g. ``Bootstrap:``/``From:``) and one or more script sections starting\n+        with ``%`` (e.g. ``%post``).\n+        \"\"\"\n+        header = re.search(\n+            r'^\\s*(?:bootstrap|from|osversion|mirrorurl|include|registry|namespace|includecmd)\\s*:',\n+            text, re.IGNORECASE | re.MULTILINE)\n+        section = re.search(SingularityLexer._section, text)\n+        appsect = re.search(SingularityLexer._appsect, text)\n+\n+        # Very strong signal: both header and a section marker are present.\n+        # This helps avoid false positives from other lexers that key on '%'.\n+        if header and (section or appsect):\n+            return 1.0\n \n+        result = 0.0\n+        if header:\n+            result += 0.6\n+        if section:\n+            result += 0.5\n+        if appsect:\n+            result += 0.4\n         return result\n \n \n",
    "success": false,
    "steps": 30,
    "estimated_tokens": 13137
}